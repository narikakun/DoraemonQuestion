let nowData=null;function getComment(o,t=1){$("#cardList").html(" "),$("#cardList").hide(),$.ajax({type:"GET",url:`/api/comment/${o}/list?page=`+t,contentType:"application/json",dataType:"json"}).done(async function(t,a,e){$("#boardId").text(o),t.comments.reverse(),await showCommentList(t.comments),nowData=t,$("#cardList").show(),1==t.pageNumber?$("#paginationBack").addClass("disabled"):$("#paginationBack").removeClass("disabled"),t.pageNumber==t.maxPage?$("#paginationNext").addClass("disabled"):$("#paginationNext").removeClass("disabled"),$("#paginationInfo").text(`　${t.pageNumber} / ${t.maxPage}　`)}).fail(function(t,a,e){$("#errorMsg").text(t.responseJSON.msg)})}let removeClassId,removeCommentId;async function removeComment(){$.ajax({type:"POST",url:`/api/admin/${removeClassId}/removeComment/`+removeCommentId,contentType:"application/json",dataType:"json"}).done(async function(t,a,e){bootstrap.showToast({body:"削除しました。",toastClass:"text-bg-primary"}),$("#comment_"+removeCommentId).remove()}).fail(function(t,a,e){$("#errorMsg").text(t.responseJSON.msg)})}async function showRemoveModal(t,a,e,o){removeClassId=t,removeCommentId=a,$("#modalId").text(a),$("#modalAuthor").text(e),$("#modalContent").text(o),$("#deleteCheckModal").modal("show")}async function showCommentList(t){let a="";a+=`<table class="table">
    <thead>
        <tr>
            <th scope="col">投稿者名</th>
            <th scope="col">内容</th>
            <th scope="col">ファイル数</th>
            <th scope="col">日付</th>
            <th scope="col">操作</th>
        </tr>
    </thead>
  <tbody>`;for(const o in t){var e=t[o];a+=`
        <tr id="comment_${e._id}">
                <td>${escapeHTML(e.author)}</td>
                <td>${escapeHTML(truncateString(e.data.content,30)||"")}</td>
                <td>${e.data.files.length}</td>
                <td>${new Date(e.createdAt).toLocaleString("ja")}</td>
                <td>
                    <button type="button" target="_blank" onclick="showRemoveModal('${e.classId}', '${e._id}', '${escapeHTML(e.author)}', '${escapeHTML(truncateString(e.data.content,30)||"")}')" class="btn btn-danger btn-sm">コメントを削除</button>
                </td>
        </tr>`}a+="</tbody></table>",$("#cardList").html(a)}$(function(){$("#paginationBack").click(function(t){var a;nowData.pageNumber<=1||(a=nowData.pageNumber-1,getBoard(nowData.classId,a))}),$("#paginationNext").click(function(t){var a;nowData.maxPage<=nowData.pageNumber||(a=nowData.pageNumber+1,getBoard(nowData.classId,a))})});